# HomeLab SOC - Custom Detection Rules
# Purple Team Lab Traffic Detection

# SQL Injection - Generic UNION SELECT
alert http any any -> any any (msg:"HOMELAB SQL Injection - UNION SELECT"; flow:established,to_server; http.uri; content:"UNION"; nocase; content:"SELECT"; nocase; distance:0; classtype:web-application-attack; sid:9000001; rev:1;)

# SQL Injection - Generic OR 1=1
alert http any any -> any any (msg:"HOMELAB SQL Injection - OR boolean"; flow:established,to_server; http.uri; pcre:"/OR\s+\d+\s*=\s*\d+/i"; classtype:web-application-attack; sid:9000002; rev:1;)

# SQL Injection - SLEEP/BENCHMARK (time-based)
alert http any any -> any any (msg:"HOMELAB SQL Injection - Time-based SLEEP"; flow:established,to_server; http.uri; content:"SLEEP"; nocase; classtype:web-application-attack; sid:9000003; rev:1;)

# SQL Injection - INFORMATION_SCHEMA
alert http any any -> any any (msg:"HOMELAB SQL Injection - INFORMATION_SCHEMA access"; flow:established,to_server; http.uri; content:"INFORMATION_SCHEMA"; nocase; classtype:web-application-attack; sid:9000004; rev:1;)

# SQLmap User-Agent Detection
alert http any any -> any any (msg:"HOMELAB SQLmap Tool Detected"; flow:established,to_server; http.user_agent; content:"sqlmap"; nocase; classtype:web-application-attack; sid:9000005; rev:1;)

# SQL Injection - Comment sequences
alert http any any -> any any (msg:"HOMELAB SQL Injection - Comment evasion"; flow:established,to_server; http.uri; content:"--"; content:"#"; distance:0; classtype:web-application-attack; sid:9000006; rev:1;)

# XSS - Script tag
alert http any any -> any any (msg:"HOMELAB XSS - Script tag in URI"; flow:established,to_server; http.uri; content:"<script"; nocase; classtype:web-application-attack; sid:9000010; rev:1;)

# XSS - Event handlers
alert http any any -> any any (msg:"HOMELAB XSS - Event handler in URI"; flow:established,to_server; http.uri; pcre:"/on(load|error|click|mouseover)\s*=/i"; classtype:web-application-attack; sid:9000011; rev:1;)

# Command Injection - Common patterns
alert http any any -> any any (msg:"HOMELAB Command Injection - Pipe character"; flow:established,to_server; http.uri; content:"|7c|"; classtype:web-application-attack; sid:9000020; rev:1;)

# Directory Traversal
alert http any any -> any any (msg:"HOMELAB Directory Traversal - dot dot slash"; flow:established,to_server; http.uri; content:"../"; classtype:web-application-attack; sid:9000021; rev:1;)
